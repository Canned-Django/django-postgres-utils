language: python
python:
  - "3.5"
  - "3.6"
  - "3.7"
  - "3.8"
env:
  - DJANGO_VERSION=2.3
  - DJANGO_VERSION=3.1
services:
  - postgresql
install: pip install psycopg2-binary PyYAML "Django<$DJANGO_VERSION"
before_script:
  - psql -U postgres -c 'create database django_postgres_utils;'
  - cd $TRAVIS_BUILD_DIR/src/
script: POSTGRES_USER="postgres" POSTGRES_PASSWORD="" ./manage.py test
before_deploy:
  - cd $TRAVIS_BUILD_DIR
deploy:
  provider: pypi
  user: "__token__"
  password:
    secure: "tJDZTs02AFpsRP0j0fHib+MNm+f9fDgWeeZnwPNZbCr0ok6W7yF7BYAUUjy0ZBAY+JvOB4mVQ+Rxg4GEdlZg7pig5GiA6sUVgRyCyt0pKCPuPFxqmqqrYHeYuX5AakIIa6AG4m3bNVvVm8MacI+QNp0f3gcumPa9xfkAW/o7yOCl9SbkzvySXNJt9iecAAE1rMcvz6D5i3LiVkwooDF7l9Pos03vqQrkQ5vrrlF8DDKWcEnzUb6zJK2FtD0l9DrlcMXctGLbrcUPDEV4jMvQ4wYF161oZOsk6bp/AX+ya4RxTP8mMkGjCl9y+4HK+9XpKvKX+1i2mv2l1LxU/PIXq3QeHf2EK8/90RCgp5EU6W//yC2XRY2FRdhRYWmLrNmkmEiRLW4G7a15aTsapvocJXKKJvMHOMjd+QuSv9iqmYzP3dhZB7A+TnS+N1EgrSoDs5niA+cPAHM42UqIy67pmaqQP4Zlw+KTQdepBYppWGp+S6+YNbhXQNsB8gFO7eetThloQmnEgc2cqgw64PGVj8Ii5xcf3l+TtQ8rQ32ZJqNy0LO7w+5EPEkrKoOmwVk/LgjN/z0Ni0pqGcml3pBX1VkqFCycCQV4h9oQCIGNRL0N+R5CnJ0uwGRSWHuvhn+C5G+lwi3vuv7Ea7S8jCcseZ5kI69hl8vvcrnonDSc/xE="
  on:
    all_branches: true
  skip_existing: true
  skip_cleanup: true